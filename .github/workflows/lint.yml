name: Lint TaggerScript

on:
  push:
    branches: [ main ]
    paths:
      - naming.pts
  pull_request:
    branches: [ main ]
    paths:
      - naming.pts

jobs:
  lint:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Check line endings
        run: |
          if file naming.pts | grep -q "CRLF"; then
            echo "❌ ERROR: File has CRLF line endings, should be LF"
            exit 1
          else
            echo "✅ Line endings are correct (LF)"
          fi

      - name: Check for trailing whitespace
        run: |
          if grep -n "[[:space:]]$" naming.pts; then
            echo "⚠️  WARNING: Trailing whitespace found on lines above"
          else
            echo "✅ No trailing whitespace"
          fi

      - name: Check indentation consistency
        run: |
          python3 -c "
          import sys

          with open('naming.pts', 'r') as f:
              lines = f.readlines()

          inconsistent = []
          for i, line in enumerate(lines, 1):
              if line.startswith(' ') and not line.startswith('  '):
                  spaces = len(line) - len(line.lstrip(' '))
                  if spaces % 2 != 0:
                      inconsistent.append(f'Line {i}: {spaces} spaces (not multiple of 2)')

          if inconsistent:
              print('⚠️  WARNING: Inconsistent indentation found:')
              for issue in inconsistent[:10]:
                  print(f'  {issue}')
              if len(inconsistent) > 10:
                  print(f'  ... and {len(inconsistent) - 10} more')
          else:
              print('✅ Indentation is consistent (2-space)')
          "

      - name: Check for TODO/FIXME comments
        run: |
          if grep -n "TODO\|FIXME\|XXX" naming.pts; then
            echo "ℹ️  INFO: TODO/FIXME comments found above"
          else
            echo "✅ No TODO/FIXME comments"
          fi
